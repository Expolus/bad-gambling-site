<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Bad Gambling Website</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 2rem;
      background-color: #f0f0f0;
      position: relative;
    }
    h1 { margin-bottom: 1rem; }
    button {
      padding: 10px 20px;
      font-size: 1rem;
      margin-bottom: 1rem;
      cursor: pointer;
      background-color: #28a745;
      color: white;
      border: none;
      border-radius: 8px;
      transition: background-color 0.3s;
    }
    button:hover { background-color: #218838; }
    #canvas {
      background: white;
      border-radius: 12px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.2);
      margin-bottom: 1rem;
    }
    #result-info { margin-bottom: 2rem; font-size: 1rem; }
    #collection {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
      gap: 1rem;
      width: 100%;
      max-width: 800px;
    }
    .collection-item {
      background: white;
      padding: 0.5rem;
      border-radius: 8px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      display: flex;
      flex-direction: column;
      align-items: center;
      cursor: pointer;
      position: relative;
      font-size: 0.8rem;
    }
    .collection-item canvas {
      border-radius: 8px;
      margin-bottom: 0.4rem;
    }
    .label { text-align: center; line-height: 1.2; }
    .popup {
      position: absolute;
      background: white;
      border: 1px solid #ccc;
      padding: 0.5rem;
      border-radius: 8px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.2);
      z-index: 100;
      font-size: 0.9rem;
    }
    @media (max-width: 600px) {
      #canvas { width: 200px; height: 200px; }
      button { font-size: 1.2rem; padding: 12px 24px; }
      h1 { font-size: 1.8rem; }
    }
  </style>
</head>
<body>

<h1>Bad Gambling Website</h1>
<button id="roll">Roll!</button>
<canvas id="canvas" width="300" height="300"></canvas>
<div id="result-info"></div>

<h2>Your Collection</h2>
<div id="collection"></div>

<script>
const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d');
const resultInfo = document.getElementById('result-info');
const collectionDiv = document.getElementById('collection');
const shapes = ['circle','square','triangle','star','hexagon','heart','pentagon'];
let rolling = false, animationInterval;

// random hex
function randomColor() {
  return '#' + Math.floor(Math.random()*0xFFFFFF).toString(16).padStart(6,'0');
}

// draw shape with gradient
function drawShape(ctx, shape, top, bot, w, h) {
  ctx.clearRect(0,0,w,h);
  const g = ctx.createLinearGradient(0,0,0,h);
  g.addColorStop(0, top);
  g.addColorStop(1, bot);
  ctx.fillStyle = g;
  ctx.beginPath();
  const cx=w/2, cy=h/2, sz=Math.min(w,h)/2.5;
  switch(shape) {
    case 'circle': ctx.arc(cx,cy,sz,0,2*Math.PI); break;
    case 'square': ctx.rect(cx-sz/2,cy-sz/2,sz,sz); break;
    case 'triangle':
      ctx.moveTo(cx,cy-sz);
      ctx.lineTo(cx-sz,cy+sz);
      ctx.lineTo(cx+sz,cy+sz);
      ctx.closePath(); break;
    case 'star': drawStar(ctx,cx,cy,5,sz,sz/2); break;
    case 'hexagon': drawPoly(ctx,cx,cy,6,sz); break;
    case 'pentagon': drawPoly(ctx,cx,cy,5,sz); break;
    case 'heart': drawHeart(ctx,cx,cy,sz); break;
  }
  ctx.fill();
}

function drawStar(ctx,cx,cy,sp,or,ir){
  let rot=Math.PI/2*3,step=Math.PI/sp;
  ctx.moveTo(cx,cy-or);
  for(let i=0;i<sp;i++){
    ctx.lineTo(cx+Math.cos(rot)*or,cy+Math.sin(rot)*or);
    rot+=step;
    ctx.lineTo(cx+Math.cos(rot)*ir,cy+Math.sin(rot)*ir);
    rot+=step;
  }
  ctx.closePath();
}

function drawPoly(ctx,cx,cy,s,r){
  const ang=2*Math.PI/s;
  ctx.moveTo(cx+r,cy);
  for(let i=1;i<=s;i++){
    ctx.lineTo(cx+r*Math.cos(i*ang),cy+r*Math.sin(i*ang));
  }
}

function drawHeart(ctx,cx,cy,s){
  ctx.moveTo(cx,cy+s/4);
  ctx.bezierCurveTo(cx+s,cy-s/2,cx+s/2,cy-s,cx,cy-s/4);
  ctx.bezierCurveTo(cx-s/2,cy-s,cx-s,cy-s/2,cx,cy+s/4);
}

// roll: cycle 4 fake gradientsâ†’final
function roll() {
  if(rolling) return;
  rolling=true;
  const shape=shapes[Math.floor(Math.random()*shapes.length)];
  // fake gradients
  const fakes=Array.from({length:4},()=>[randomColor(),randomColor()]);
  let idx=0;
  animationInterval=setInterval(()=>{
    const [t,b]=fakes[idx];
    drawShape(ctx,shape,t,b,canvas.width,canvas.height);
    idx=(idx+1)%4;
  },150);

  setTimeout(()=>{
    clearInterval(animationInterval);
    const top=randomColor(), bot=randomColor();
    drawShape(ctx,shape,top,bot,canvas.width,canvas.height);
    resultInfo.innerHTML =
      `<strong>Shape:</strong> ${shape} | <strong>Top:</strong> ${top} | <strong>Bot:</strong> ${bot}`;

    // save lastRoll
    localStorage.setItem('lastRoll', JSON.stringify({shape,top,bot}));

    // save to collection
    const coll = JSON.parse(localStorage.getItem('collection')||'[]');
    coll.push({shape,top,bot});
    localStorage.setItem('collection', JSON.stringify(coll));
    addItem({shape,top,bot});

    rolling=false;
  },2000);
}

// add collection item with labels
function addItem({shape,top,bot}) {
  const div=document.createElement('div');
  div.className='collection-item';
  div.dataset.shape=shape;
  div.dataset.top=top;
  div.dataset.bot=bot;

  const mini=document.createElement('canvas');
  mini.width=100; mini.height=100;
  drawShape(mini.getContext('2d'),shape,top,bot,100,100);
  div.appendChild(mini);

  const lbl=document.createElement('div');
  lbl.className='label';
  lbl.innerHTML = `<strong>${shape}</strong><br>${top}<br>${bot}`;
  div.appendChild(lbl);

  collectionDiv.appendChild(div);
  div.addEventListener('click',()=>showPopup(div));
}

// load on startup
function init() {
  // load collection
  JSON.parse(localStorage.getItem('collection')||'[]')
    .forEach(item=>addItem(item));
  // load last roll
  const last = JSON.parse(localStorage.getItem('lastRoll'));
  if(last) {
    drawShape(ctx, last.shape, last.top, last.bot, canvas.width, canvas.height);
    resultInfo.innerHTML =
      `<strong>Shape:</strong> ${last.shape} | <strong>Top:</strong> ${last.top} | <strong>Bot:</strong> ${last.bot}`;
  }
}

// popup & dismiss
function showPopup(item) {
  document.querySelectorAll('.popup').forEach(x=>x.remove());
  const pop=document.createElement('div');
  pop.className='popup';
  pop.innerHTML =
    `<strong>Shape:</strong> ${item.dataset.shape}<br>`+
    `<strong>Top:</strong> ${item.dataset.top}<br>`+
    `<strong>Bot:</strong> ${item.dataset.bot}`;
  document.body.appendChild(pop);
  const r=item.getBoundingClientRect();
  pop.style.top  = (window.scrollY + r.top) + 'px';
  pop.style.left = (r.right + 10) + 'px';

  window.addEventListener('click', function fn(e){
    if(!item.contains(e.target) && !pop.contains(e.target)) {
      pop.remove();
      window.removeEventListener('click', fn);
    }
  });
}

document.getElementById('roll').addEventListener('click', roll);
window.addEventListener('load', init);
</script>

</body>
</html>
